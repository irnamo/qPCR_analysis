---
title: "bio258_project_INM"
author: "Iris Mollhoff"
date: "2023-12-06"
output: html_document
---

# **Report** -- 2023.12.07
This r-markdown contains the code to reproducibly load qPCR data, process, perform statistical analysis, and generate a figure. Instead of copying and pasting multiple messy chunks and replacing called variables, I have much more control in this version to cleanly run the code.

The downsides are that there are less frills. I couldn't figure out how or whether I wanted to show all of the statistical checks that I usually do prior to statistical analysis (e.g. normailty, sphericity, equal variance).

## **Goals**
1. Check housekeeping genes have low variance. actin vs. VIN3
2. Determine if FLS3 and WAK1 espression in response to flgII-28 in WT plants is as expected.
3. Determine optimal time window for future WT vs delta-ACET1 comparison

# **R Code**
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
## Clear global enviornment
```{r}
rm(list = ls())
```
##Load required packages
```{r}
library(pcr)
library(tidyverse)
library(ggpubr)
library(readxl)
library(scales)
library(ggtext)
library(multcomp)
library(lsmeans)
library(rcompanion)
library(viridis)
library(ggprism)
library(FSA)
library(gtools)
library(gginnards)
library(multcompView)
library(ggtext)
library(scales)
library(rstatix)
library(pastecs)
library(car)
```


## load data
```{r}
source("01_processing/loadfile_csv.R")

datafolder <- "E:/Files/PhD Files 2 Iris Mollhoff/Git stuff/qPCR_analysis_flgII28/data/"

rawcq <- loadfile_csv(datafolder,"20240122_a83_WT_actin-vin3-fls3-wak1")

key <- loadfile_csv(datafolder,"20221022_a83_samplekey")
```

## Process data
### clean data
```{r}
source("01_processing/cleandata_384.R")

d <- cleandata_384(rawcq)
```
### clean key
```{r}
source("01_processing/cleankey.R")

k <- cleankey(key)
```
###Combine data and key
```{r}
df <- right_join(k,d,by = "Sample")
```


### calculate techrep
```{r}
source("01_processing/calctecrep.R")

df1 <- calctecrep(df)
```
### Pull actin (housekeeping gene)
```{r}
source("01_processing/pullhkg.R")

df_hkg <- pullhkg(df1, "SlActin")
```
### calculate delta Ct
```{r}
source("01_processing/deltact.R")

df2 <- deltact(df1,df_hkg, "SlAcet1")
```

## Data analysis
### Statistics
```{r}
source("02_analysis/anova2x.R")

anova_treatment <- anova2x(df2)
```

## Generate figure
### figure
```{r}
source("03_figures/figure.R")

fig1a <- figure(df2,"Sl Acet1a/b (6hpi)")
```
### Save figure to file directory
```{r}
#source("03_figures/savefig.R")
#folder<-"E:/Files/PhD Files 2 Iris Mollhoff/Git stuff/qPCR_analysis/experiments/"
#filename<-"20231207_a14_acet1_6h_anovabonf"
#fig1a <- figure(fig1a,folder,filename)

#RETURNS: Error in figure(fig1a, folder, filename) : unused argument (filename)
```
```{r}
folder_location<-"E:/Files/PhD Files 2 Iris Mollhoff/Git stuff/qPCR_analysis/experiments/"
file_name<-"20231207_a14_acet1_6h_anovabonf" 
##change file name but keep directory the same

path <-paste(folder_location,file_name,".png",sep = "")
  
  ggsave(filename = path,
         device = "png",
         height = 4, width = 5)
  path
```


